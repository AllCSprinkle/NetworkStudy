# 4장
## 경계 경로 프로토콜(BGP. Border Gateway Protocol)
인터넷이란 것은 거대한 단일 네트워크가 아닌 여러가지의 소규모 네트워크가 모여진 형태로 이루어져 있다.
이런 연결을 가능하게 하는것이 인터넷 라우팅 표준으로 통하고 있는 `경계 경로 프로토콜(BGP)`이다.

BGP는 IP 패킷 라우팅 정보가 인터넷을 통해서 AS(자율 시스템, 작은 단일 네트워크) 사이에서 교환되는 방식을 정의하는 대규모 프로토콜이다.

AS는 라우터를 통해 서로 연결된 수많은 컴퓨터로 구성되며, 이 중 전체 AS의 출입구 역할을 하는 라우터를 `BGP라우터`라고 한다.

### BGP 라우터
다양한 AS로 구성된 BGP 라우터는 서로 통신을 하는데 이를 `세션(Session)`이라고 한다. 

세션이 시작되면 세션에 참여한 AS들끼리 서로 이웃이 되고, 서로 통신할 때는 각자가 알고 있고 공유하고 싶은 모든 경로의 지도를 교환해서 BGP를 사용해 제시된 경로를 추적하고 다양한 속성에 따라 경로의 우선순의를 계산 할 수 있다.

### 대등 접속
규모가 큰 AS끼리는  대도시처럼 크고 쾌적한 고속도로처럼 연결되어 있다. 인구수와 이동량이 비슷한 경우 고속도로 요금을 무료로 하는편이 서로 이득인 만큼 인터넷에서는 이러한 경우를 `대등 접속(Peering)` 이라고 한다.

### 중계
규모가 작은 AS에서 큰AS로 가는경우 그만큼 요금을 더 내야하고 더 많은 패킷을 전달할수록 당연히 요금도 올라가는데 이를 `중계(Transit)`이라고 한다. ISP네트워크 입장에서는 중계 접속 비용을 내는 것보다 조금 돌아가더라도 무료경로로 패킷을 보내는게 더 효율적일 수 있어 `BGP는 최적의 경로를 계산할 때 거리 뿐만 아니라 중계 접속도 고려`하게 된다.

## 인터넷 익스체인지 포인트(IXP)
인터넷 익스체인지 포인트(IXP)는 수십 수백개에 달하는 AS의 물리적 연결점을 말한다. 그래서 IXP는 대부분 데이터센터나 수천대의 컴퓨터와 케이블이 연중무휴 운영되는 빌딩에 있다.

## 사용자 데이터그램 프로토콜(UDP)
인터넷의 가장 기본적인 프로토콜이다.

데이터그램은 말 그대로 작은 단위의 데이터라는 뜻이다.

UDP는 신뢰성이나 정확성보다는 속도를 우선시한다.

UDP는 포트번호를 포함한 헤더를 각 데이터그램에 추가하고 소스어플리케잇현의 포트번호와 대상호스트에 있는 소프트웨어 또는 서비스의 포트번호가 적혀있다.

## 전송 제어 프로토콜(TCP)
UDP가 효과적인 어플리케이션도 있지만, 느리더라도 올바른 순서로 데이터로 재구성하는것이 더 좋을때도 있다. 이를 위해 TCP프로토콜을 사용한다.

TCP는 각 노드에서 애플리케이션이 보내려는 데이터를 더 작은 데이터를 쪼개는데 이것이 세그먼트라고합니다. 
세그먼트로 전송과정을 추적할수있게 번호를 매기고 TCP는 모든 세그먼트를 개별적으로 IP 소프트웨어에 전송한다.

그러면 각 세그먼트가 패킷으로 압축이되고 수신자는 다시 패킷을 하나하나 검사하며 제대로 전송이 됐는지 확인하는 과정을 거칩니다.